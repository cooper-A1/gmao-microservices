# .env.example pour le service Stock
ENVIRONMENT=development
PORT=8004
REDIS_URL=redis://localhost:6379
JWT_SECRET=your-super-secret-jwt-key-change-in-production

# Makefile
.PHONY: build run test docker-build docker-run clean

# Variables
BINARY_NAME=stock-service
DOCKER_IMAGE=ics-gmao/stock-service:latest

# Build de l'application
build:
	@echo "üî® Building Stock Service..."
	go build -o bin/$(BINARY_NAME) .
	@echo "‚úÖ Build completed!"

# Ex√©cution en local
run:
	@echo "üöÄ Running Stock Service..."
	go run .

# Tests
test:
	@echo "üß™ Running tests..."
	go test -v ./...

# Build de l'image Docker
docker-build:
	@echo "üê≥ Building Docker image..."
	docker build -t $(DOCKER_IMAGE) .
	@echo "‚úÖ Docker image built successfully!"

# Ex√©cution du conteneur Docker
docker-run:
	@echo "üöÄ Running Docker container..."
	docker run -p 8004:8004 --env-file .env $(DOCKER_IMAGE)

# Nettoyage
clean:
	@echo "üßπ Cleaning..."
	rm -rf bin/
	docker rmi $(DOCKER_IMAGE) 2>/dev/null || true
	@echo "‚úÖ Cleaned!"

# Format du code
fmt:
	go fmt ./...

# V√©rification du code
lint:
	golangci-lint run

# Installation des d√©pendances de d√©veloppement
dev-deps:
	go install github.com/swaggo/swag/cmd/swag@latest
	go install github.com/golangci/golangci-lint/cmd/golangci-lint@latest

# G√©n√©ration de la documentation Swagger
swagger:
	swag init -g main.go